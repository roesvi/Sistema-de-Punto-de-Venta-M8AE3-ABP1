import{_ as at,c as l,a as t,b as h,w as C,v as _,d as f,F as x,r as k,n as w,t as d,e as A,f as lt,u as nt,g as c,h as u,o as it,i as dt,j as n}from"./index-1NJw5fJc.js";import{M as rt}from"./bootstrap.esm-CITe24HP.js";const ct={name:"PointOfSale",setup(){dt();const m=nt(),e=c(""),j=c(!1),o=c(null),b=c(1),p=12,s=c(""),r=c(null),E=c(!1),F=c("cash"),y=c(0),P=c(0),g=c(0);let M=null;const L=c([{id:1,name:"Laptop HP 15-dw1001la",price:1299990,stock:15,category:{id:1,name:"Tecnología"}},{id:2,name:"Mouse Inalámbrico Logitech",price:29990,stock:42,category:{id:1,name:"Tecnología"}},{id:3,name:"Teclado Mecánico RGB",price:89990,stock:23,category:{id:1,name:"Tecnología"}},{id:4,name:'Monitor 24" Full HD',price:199990,stock:8,category:{id:1,name:"Tecnología"}},{id:5,name:"Impresora Multifuncional",price:149990,stock:12,category:{id:1,name:"Tecnología"}},{id:6,name:"Audífonos Bluetooth",price:59990,stock:30,category:{id:2,name:"Audio"}},{id:7,name:"Parlante Portátil",price:79990,stock:18,category:{id:2,name:"Audio"}},{id:8,name:"Disco Duro Externo 1TB",price:69990,stock:5,category:{id:1,name:"Tecnología"}},{id:9,name:"Webcam HD",price:49990,stock:25,category:{id:1,name:"Tecnología"}},{id:10,name:"Mouse Pad Grande",price:12990,stock:50,category:{id:1,name:"Tecnología"}},{id:11,name:"Silla Gamer",price:249990,stock:7,category:{id:3,name:"Muebles"}},{id:12,name:"Escritorio para Computadora",price:179990,stock:4,category:{id:3,name:"Muebles"}}]),Q=c([{id:1,name:"Tecnología"},{id:2,name:"Audio"},{id:3,name:"Muebles"},{id:4,name:"Oficina"},{id:5,name:"Accesorios"}]),T=c([{id:1,name:"Cliente General",email:"",phone:""},{id:2,name:"Roberto Escobar",email:"rober@example.com",phone:"+56 9 1234 5678"},{id:3,name:"María González",email:"maria@example.com",phone:"+56 9 8765 4321"},{id:4,name:"Empresa XYZ S.A.",email:"contacto@empresa.cl",phone:"+56 2 2345 6789"}]),R=u(()=>{let a=[...L.value];if(e.value){const i=e.value.toLowerCase();a=a.filter(v=>v.name.toLowerCase().includes(i)||(v.category?.name||"").toLowerCase().includes(i))}return o.value&&(a=a.filter(i=>i.category?.id===o.value)),a}),q=u(()=>{if(!s.value)return T.value.slice(0,5);const a=s.value.toLowerCase();return T.value.filter(i=>i.name.toLowerCase().includes(a)||(i.email||"").toLowerCase().includes(a)||(i.phone||"").includes(a)).slice(0,5)}),U=u(()=>{const a=(b.value-1)*p,i=a+p;return R.value.slice(a,i)}),z=u(()=>Math.ceil(R.value.length/p)),V=u(()=>m.cart),S=u(()=>V.value.reduce((a,i)=>a+i.price*i.quantity,0)-y.value),G=.19,D=u(()=>S.value*G),N=u(()=>S.value+D.value),O=()=>{b.value=1},H=a=>{o.value=a,b.value=1,j.value=!1},W=()=>{o.value=null,b.value=1},X=a=>{a>=1&&a<=z.value&&(b.value=a,window.scrollTo({top:0,behavior:"smooth"}))},B=a=>new Intl.NumberFormat("es-CL",{style:"decimal",minimumFractionDigits:0,maximumFractionDigits:0}).format(a),I=a=>{r.value=a,s.value=a.name,E.value=!1},Y=()=>{const a={id:T.value.length+1,name:s.value,email:"",phone:""};T.value.unshift(a),I(a),m.addNotification({type:"success",message:"Cliente agregado correctamente",read:!1})},Z=a=>{m.addToCart(a)},J=(a,i)=>{i<1&&(i=1);const v=L.value.find(st=>st.id===a);v&&i>v.stock&&(i=v.stock,m.addNotification({type:"warning",message:`Solo hay ${v.stock} unidades disponibles`,read:!1})),m.updateQuantity(a,i)},K=a=>{m.removeFromCart(a)},$=()=>{confirm("¿Estás seguro de que deseas vaciar el carrito?")&&(m.clearCart(),y.value=0)},tt=a=>{F.value=a,P.value=0,g.value=0,M||(M=new rt(document.getElementById("paymentModal"))),M.show()},et=()=>{g.value=parseFloat(P.value)-N.value,isNaN(g.value)&&(g.value=0)},ot=()=>{const a={id:Date.now(),date:new Date,customer:r.value,items:[...V.value],subtotal:S.value,tax:D.value,discount:y.value,total:N.value,paymentMethod:F.value,amountReceived:P.value,change:g.value};console.log("Sale completed:",a),m.addNotification({type:"success",message:`Venta completada por $${B(N.value)}`,read:!1}),M.hide(),m.clearCart(),y.value=0,r.value=null,s.value=""};return it(()=>{}),{searchQuery:e,showCategories:j,selectedCategory:o,currentPage:b,itemsPerPage:p,customerSearch:s,selectedCustomer:r,showCustomerDropdown:E,discount:y,amountReceived:P,change:g,paymentMethod:F,filteredProducts:U,totalPages:z,cart:V,subtotal:S,tax:D,total:N,categories:Q,filteredCustomers:q,filterProducts:O,selectCategory:H,clearCategoryFilter:W,changePage:X,formatPrice:B,selectCustomer:I,addNewCustomer:Y,addToCart:Z,updateQuantity:J,removeFromCart:K,clearCart:$,processPayment:tt,calculateChange:et,completeSale:ot}}},mt={class:"pos-container"},ut={class:"row g-3"},bt={class:"col-lg-8"},vt={class:"card h-100"},gt={class:"card-header bg-white border-bottom-0"},ft={class:"d-flex justify-content-between align-items-center"},pt={class:"d-flex"},yt={class:"input-group input-group-sm me-2",style:{"max-width":"300px"}},ht={key:0,class:"mt-3"},Ct={class:"d-flex flex-wrap gap-2"},_t=["onClick"],xt={class:"card-body p-0"},kt={key:0,class:"text-center py-5"},wt={key:1,class:"row row-cols-2 row-cols-md-3 row-cols-lg-4 g-2 p-2"},Pt=["onClick"],Mt={class:"position-relative"},Tt=["src","alt"],St={class:"position-absolute top-0 end-0 m-2"},Nt={class:"badge bg-success"},jt={key:0,class:"position-absolute bottom-0 start-0 w-100 bg-warning text-dark text-center p-1",style:{"font-size":"0.7rem"}},Ft={class:"card-body p-2"},Vt=["title"],Dt={class:"card-text small text-muted mb-0"},At={key:2,class:"d-flex justify-content-center mt-3 mb-3"},Et={class:"pagination pagination-sm"},Lt=["onClick"],Rt={class:"col-lg-4"},zt={class:"card h-100"},Bt={class:"card-body p-0 d-flex flex-column",style:{height:"75vh","max-height":"80vh"}},It={class:"p-3 border-bottom"},Qt={class:"input-group input-group-sm mb-2"},qt={key:0,class:"position-relative"},Ut={class:"dropdown-menu d-block position-static mt-1 w-100",style:{"z-index":"1060"}},Gt={class:"p-2"},Ot=["onClick"],Ht={class:"d-flex justify-content-between align-items-center"},Wt={class:"fw-semibold"},Xt={class:"text-muted"},Yt={class:"text-muted"},Zt={key:0,class:"text-center py-2 text-muted"},Jt={class:"flex-grow-1 overflow-auto p-3",style:{"max-height":"300px"}},Kt={key:0,class:"text-center py-5"},$t={key:1},te={class:"d-flex align-items-center"},ee={class:"flex-grow-1"},oe={class:"d-flex justify-content-between align-items-start"},se={class:"mb-0"},ae={class:"text-muted"},le={class:"text-end"},ne={class:"d-flex align-items-center"},ie=["onClick","disabled"],de=["onUpdate:modelValue","onChange"],re=["onClick"],ce=["onClick"],me={class:"mt-1 text-end fw-bold"},ue={class:"border-top p-3"},be={class:"d-flex justify-content-between mb-2"},ve={class:"input-group input-group-sm mb-2"},ge=["max"],fe={class:"d-flex justify-content-between mb-2"},pe={class:"d-flex justify-content-between fw-bold fs-5 mb-3"},ye={class:"row g-2 mb-2"},he={class:"col-6"},Ce=["disabled"],_e={class:"col-6"},xe=["disabled"],ke={class:"d-grid"},we=["disabled"],Pe={class:"modal fade",id:"paymentModal",tabindex:"-1","aria-hidden":"true"},Me={class:"modal-dialog"},Te={class:"modal-content"},Se={class:"modal-header"},Ne={class:"modal-title"},je={class:"modal-body"},Fe={key:0},Ve={class:"mb-3"},De=["value"],Ae={class:"mb-3"},Ee={class:"mb-3"},Le=["value"],Re={key:1},ze={class:"alert alert-info mb-0"},Be={class:"modal-footer"},Ie=["disabled"];function Qe(m,e,j,o,b,p){return n(),l("div",mt,[t("div",ut,[t("div",bt,[t("div",vt,[t("div",gt,[t("div",ft,[e[18]||(e[18]=t("h5",{class:"mb-0"},"Productos",-1)),t("div",pt,[t("div",yt,[e[16]||(e[16]=t("span",{class:"input-group-text bg-light border-end-0"},[t("i",{class:"bi bi-search"})],-1)),C(t("input",{type:"text",class:"form-control border-start-0",placeholder:"Buscar productos...","onUpdate:modelValue":e[0]||(e[0]=s=>o.searchQuery=s),onInput:e[1]||(e[1]=(...s)=>o.filterProducts&&o.filterProducts(...s))},null,544),[[_,o.searchQuery]])]),t("button",{class:"btn btn-sm btn-outline-secondary",onClick:e[2]||(e[2]=s=>o.showCategories=!o.showCategories)},[...e[17]||(e[17]=[t("i",{class:"bi bi-funnel"},null,-1),f(" Categorías ",-1)])])])]),o.showCategories?(n(),l("div",ht,[t("div",Ct,[(n(!0),l(x,null,k(o.categories,s=>(n(),l("button",{key:s.id,class:w(["btn btn-sm",{"btn-primary":o.selectedCategory===s.id,"btn-outline-secondary":o.selectedCategory!==s.id}]),onClick:r=>o.selectCategory(s.id)},d(s.name),11,_t))),128)),t("button",{class:"btn btn-sm btn-outline-danger",onClick:e[3]||(e[3]=(...s)=>o.clearCategoryFilter&&o.clearCategoryFilter(...s))},[...e[19]||(e[19]=[t("i",{class:"bi bi-x-lg"},null,-1)])])])])):h("",!0)]),t("div",xt,[o.filteredProducts.length===0?(n(),l("div",kt,[...e[20]||(e[20]=[t("div",{class:"text-muted"},[t("i",{class:"bi bi-search",style:{"font-size":"3rem"}}),t("p",{class:"mt-3"},"No se encontraron productos")],-1)])])):(n(),l("div",wt,[(n(!0),l(x,null,k(o.filteredProducts,s=>(n(),l("div",{class:"col",key:s.id},[t("div",{class:"product-card card h-100 border-0 shadow-sm",onClick:r=>o.addToCart(s)},[t("div",Mt,[t("img",{src:s.image||`https://ui-avatars.com/api/?name=${encodeURIComponent(s.name||"P")}&background=random`,class:"card-img-top",alt:s.name,style:{height:"120px","object-fit":"cover"}},null,8,Tt),t("div",St,[t("span",Nt,"$"+d(o.formatPrice(s.price)),1)]),s.stock<=5?(n(),l("div",jt,d(s.stock)+" en stock ",1)):h("",!0)]),t("div",Ft,[t("h6",{class:"card-title mb-1 text-truncate",title:s.name},d(s.name),9,Vt),t("p",Dt,d(s.category?.name||"Sin categoría"),1)])],8,Pt)]))),128))])),o.totalPages>1?(n(),l("nav",At,[t("ul",Et,[t("li",{class:w(["page-item",{disabled:o.currentPage===1}])},[t("button",{class:"page-link",onClick:e[4]||(e[4]=s=>o.changePage(o.currentPage-1))},[...e[21]||(e[21]=[t("i",{class:"bi bi-chevron-left"},null,-1)])])],2),(n(!0),l(x,null,k(o.totalPages,s=>(n(),l("li",{key:s,class:w(["page-item",{active:o.currentPage===s}])},[t("button",{class:"page-link",onClick:r=>o.changePage(s)},d(s),9,Lt)],2))),128)),t("li",{class:w(["page-item",{disabled:o.currentPage===o.totalPages}])},[t("button",{class:"page-link",onClick:e[5]||(e[5]=s=>o.changePage(o.currentPage+1))},[...e[22]||(e[22]=[t("i",{class:"bi bi-chevron-right"},null,-1)])])],2)])])):h("",!0)])])]),t("div",Rt,[t("div",zt,[e[38]||(e[38]=t("div",{class:"card-header bg-white border-bottom-0"},[t("h5",{class:"mb-0"},"Orden Actual")],-1)),t("div",Bt,[t("div",It,[t("div",Qt,[e[24]||(e[24]=t("span",{class:"input-group-text bg-light border-end-0"},[t("i",{class:"bi bi-person"})],-1)),C(t("input",{type:"text",class:"form-control",placeholder:"Cliente","onUpdate:modelValue":e[6]||(e[6]=s=>o.customerSearch=s),onFocus:e[7]||(e[7]=s=>o.showCustomerDropdown=!0)},null,544),[[_,o.customerSearch]]),t("button",{class:"btn btn-outline-secondary",type:"button",onClick:e[8]||(e[8]=(...s)=>o.addNewCustomer&&o.addNewCustomer(...s))},[...e[23]||(e[23]=[t("i",{class:"bi bi-plus-lg"},null,-1)])])]),o.showCustomerDropdown?(n(),l("div",qt,[t("div",Ut,[t("div",Gt,[(n(!0),l(x,null,k(o.filteredCustomers,s=>(n(),l("div",{key:s.id,class:"dropdown-item cursor-pointer",onClick:r=>o.selectCustomer(s)},[t("div",Ht,[t("div",null,[t("div",Wt,d(s.name),1),t("small",Xt,d(s.email||"Sin correo"),1)]),t("small",Yt,d(s.phone||"Sin teléfono"),1)])],8,Ot))),128)),o.filteredCustomers.length===0?(n(),l("div",Zt,[...e[25]||(e[25]=[t("small",null,"No se encontraron clientes",-1)])])):h("",!0)])])])):h("",!0)]),t("div",Jt,[o.cart.length===0?(n(),l("div",Kt,[...e[26]||(e[26]=[t("div",{class:"text-muted"},[t("i",{class:"bi bi-cart-x",style:{"font-size":"2rem"}}),t("p",{class:"mt-2 mb-0"},"El carrito está vacío"),t("small",null,"Agrega productos para comenzar")],-1)])])):(n(),l("div",$t,[(n(!0),l(x,null,k(o.cart,s=>(n(),l("div",{key:s.id,class:"mb-2"},[t("div",te,[t("div",ee,[t("div",oe,[t("div",null,[t("h6",se,d(s.name),1),t("small",ae,"$"+d(o.formatPrice(s.price))+" c/u",1)]),t("div",le,[t("div",ne,[t("button",{class:"btn btn-sm btn-outline-secondary py-0 px-2",onClick:A(r=>o.updateQuantity(s.id,s.quantity-1),["stop"]),disabled:s.quantity<=1},[...e[27]||(e[27]=[t("i",{class:"bi bi-dash"},null,-1)])],8,ie),C(t("input",{type:"number",class:"form-control form-control-sm text-center mx-1",style:{width:"50px"},"onUpdate:modelValue":r=>s.quantity=r,min:"1",onChange:r=>o.updateQuantity(s.id,s.quantity)},null,40,de),[[_,s.quantity,void 0,{number:!0}]]),t("button",{class:"btn btn-sm btn-outline-secondary py-0 px-2",onClick:A(r=>o.updateQuantity(s.id,s.quantity+1),["stop"])},[...e[28]||(e[28]=[t("i",{class:"bi bi-plus"},null,-1)])],8,re),t("button",{class:"btn btn-sm btn-outline-danger ms-2",onClick:A(r=>o.removeFromCart(s.id),["stop"])},[...e[29]||(e[29]=[t("i",{class:"bi bi-trash"},null,-1)])],8,ce)]),t("div",me," $"+d(o.formatPrice(s.price*s.quantity)),1)])])])])]))),128))]))]),t("div",ue,[t("div",be,[e[30]||(e[30]=t("span",null,"Subtotal:",-1)),t("span",null,"$"+d(o.formatPrice(o.subtotal)),1)]),t("div",ve,[e[31]||(e[31]=t("span",{class:"input-group-text"},"Descuento",-1)),C(t("input",{type:"number",class:"form-control text-end","onUpdate:modelValue":e[9]||(e[9]=s=>o.discount=s),min:"0",max:o.subtotal,step:"0.01"},null,8,ge),[[_,o.discount,void 0,{number:!0}]]),e[32]||(e[32]=t("span",{class:"input-group-text"},"$",-1))]),t("div",fe,[e[33]||(e[33]=t("span",null,"IVA (19%):",-1)),t("span",null,"$"+d(o.formatPrice(o.tax)),1)]),t("div",pe,[e[34]||(e[34]=t("span",null,"Total:",-1)),t("span",null,"$"+d(o.formatPrice(o.total)),1)]),t("div",ye,[t("div",he,[t("button",{class:"btn btn-success w-100",disabled:o.cart.length===0,onClick:e[10]||(e[10]=s=>o.processPayment("cash"))},[...e[35]||(e[35]=[t("i",{class:"bi bi-cash-coin me-2"},null,-1),f(" Efectivo ",-1)])],8,Ce)]),t("div",_e,[t("button",{class:"btn btn-primary w-100",disabled:o.cart.length===0,onClick:e[11]||(e[11]=s=>o.processPayment("card"))},[...e[36]||(e[36]=[t("i",{class:"bi bi-credit-card me-2"},null,-1),f(" Tarjeta ",-1)])],8,xe)])]),t("div",ke,[t("button",{class:"btn btn-outline-secondary btn-sm",disabled:o.cart.length===0,onClick:e[12]||(e[12]=(...s)=>o.clearCart&&o.clearCart(...s))},[...e[37]||(e[37]=[t("i",{class:"bi bi-x-circle me-1"},null,-1),f(" Cancelar ",-1)])],8,we)])])])])])]),t("div",Pe,[t("div",Me,[t("div",Te,[t("div",Se,[t("h5",Ne,"Pago con "+d(o.paymentMethod==="cash"?"Efectivo":"Tarjeta"),1),e[39]||(e[39]=t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1))]),t("div",je,[o.paymentMethod==="cash"?(n(),l("div",Fe,[t("div",Ve,[e[40]||(e[40]=t("label",{class:"form-label"},"Total a pagar",-1)),t("input",{type:"text",class:"form-control form-control-lg text-end fw-bold",value:"$"+o.formatPrice(o.total),disabled:""},null,8,De)]),t("div",Ae,[e[41]||(e[41]=t("label",{class:"form-label"},"Recibido",-1)),C(t("input",{type:"number",class:"form-control form-control-lg text-end","onUpdate:modelValue":e[13]||(e[13]=s=>o.amountReceived=s),onInput:e[14]||(e[14]=(...s)=>o.calculateChange&&o.calculateChange(...s)),step:"0.01",min:"0"},null,544),[[_,o.amountReceived,void 0,{number:!0}]])]),t("div",Ee,[e[42]||(e[42]=t("label",{class:"form-label"},"Cambio",-1)),t("input",{type:"text",class:w(["form-control form-control-lg text-end fw-bold",{"text-success":o.change>=0,"text-danger":o.change<0}]),value:o.change>=0?"$"+o.formatPrice(o.change):"Faltan $"+o.formatPrice(Math.abs(o.change)),disabled:""},null,10,Le)])])):(n(),l("div",Re,[e[44]||(e[44]=lt('<div class="mb-3" data-v-6b4a6f23><label class="form-label" data-v-6b4a6f23>Número de tarjeta</label><div class="input-group" data-v-6b4a6f23><input type="text" class="form-control" placeholder="1234 5678 9012 3456" data-v-6b4a6f23><span class="input-group-text" data-v-6b4a6f23><i class="bi bi-credit-card" data-v-6b4a6f23></i></span></div></div><div class="row" data-v-6b4a6f23><div class="col-md-6 mb-3" data-v-6b4a6f23><label class="form-label" data-v-6b4a6f23>Vencimiento</label><input type="text" class="form-control" placeholder="MM/AA" data-v-6b4a6f23></div><div class="col-md-6 mb-3" data-v-6b4a6f23><label class="form-label" data-v-6b4a6f23>CVV</label><div class="input-group" data-v-6b4a6f23><input type="text" class="form-control" placeholder="123" data-v-6b4a6f23><span class="input-group-text" data-v-6b4a6f23><i class="bi bi-shield-lock" data-v-6b4a6f23></i></span></div></div></div><div class="mb-3" data-v-6b4a6f23><label class="form-label" data-v-6b4a6f23>Titular de la tarjeta</label><input type="text" class="form-control" placeholder="Nombre como aparece en la tarjeta" data-v-6b4a6f23></div>',3)),t("div",ze,[e[43]||(e[43]=t("i",{class:"bi bi-info-circle me-2"},null,-1)),f(" Se realizará un cargo por $"+d(o.formatPrice(o.total))+" a su tarjeta. ",1)])]))]),t("div",Be,[e[46]||(e[46]=t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Cancelar",-1)),t("button",{type:"button",class:"btn btn-primary",disabled:o.paymentMethod==="cash"&&o.change<0,onClick:e[15]||(e[15]=(...s)=>o.completeSale&&o.completeSale(...s))},[...e[45]||(e[45]=[t("i",{class:"bi bi-check2-circle me-1"},null,-1),f(" Confirmar pago ",-1)])],8,Ie)])])])])])}const Ge=at(ct,[["render",Qe],["__scopeId","data-v-6b4a6f23"]]);export{Ge as default};
